% !TeX TS-program = LuaLatex
% !TeX spellcheck = en
% !BIB TS-program = biber
% !TeX encoding = UTF-8 Unicode
% -*- coding: UTF-8; -*-
% vim: set fenc=utf-8
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% il y a aussi tikzposter qui est bien cf https://www.overleaf.com/learn/latex/Posters
\documentclass[landscape,a0]{a0poster}
%\documentclass[landscape,a0, draft]{a0poster}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\doc}{poster}

\newcommand{\Title}{
Learning heterogeneous delays of spiking neurons for motion detection
%Learning hetero-synaptic delays for motion detection in a population of Spiking Neurons
%FAST MOTION DETECTION USING HETERO-SYNAPTIC DELAYS IN A LAYER OF SPIKING NEURONS
}
\newcommand{\AuthorAG}{Antoine Grimaldi}
\newcommand{\AuthorCB}{Camille Besnainou}
\newcommand{\AuthorHL}{Hugo Ladret}
\newcommand{\AuthorLP}{Laurent U Perrinet}
\newcommand{\EmailLP}{laurent.perrinet@univ-amu.fr}
\newcommand{\EmailAG}{antoine.grimaldi@univ-amu.fr}
\newcommand{\EmailHL}{hugo.ladret@univ-amu.fr}
\newcommand{\orcidLP}{0000-0002-9536-010X}
\newcommand{\orcidHL}{0000-0001-7999-3751}
\newcommand{\orcidAG}{0000-0002-3107-4788}
\newcommand{\Address}{Institut de Neurosciences de la Timone (UMR 7289); Aix Marseille Univ, CNRS; Marseille, France}%
\newcommand{\Affiliation}{Aix Marseille Univ, CNRS}%
\newcommand{\CityLP}{Marseille, France}%
\newcommand{\WebsiteLP}{https://laurentperrinet.github.io}%
\newcommand{\Abstract}{
The response of a biological neuron depends on the precise timing of afferent spikes. This temporal aspect of the neural code is essential to understand information processing in neurobiology and applies particularly well to the output of neuromorphic hardware such as event-based cameras. However, most artificial neural models do not take advantage of this important temporal dimension of the neural code. Inspired by this neuroscientific observation, we develop a model for the efficient detection of temporal spiking motifs based on a layer of spiking neurons with heterogeneous synaptic delays. The model uses the property that the diversity of synaptic delays on the dendritic tree allows for the synchronization of specific arrangements of synaptic inputs as they reach the basal dendritic tree. We show that this can be formalized as a time-invariant logistic regression that can be trained on labeled data. We demonstrate its application to synthetic naturalistic videos transformed into event streams similar to the output of the retina or to event-based cameras and for which we will characterize the accuracy of the model in detecting visual motion. In particular, we quantify how the accuracy can vary as a function of the overall computational load showing it is still efficient at very low workloads. This end-to-end, event-driven computational building block could improve the performance of future spiking neural network (SNN) algorithms and in particular their implementation in neuromorphic chips.
}
\newcommand{\Keywords}{time code, event-based computations, spiking neural networks, motion detection, efficient coding, logistic regression
}
\newcommand{\Acknowledgments}{AG and LP received funding from the European Union ERA-NET CHIST-ERA 2018 research and innovation program under grant agreement N° ANR-19-CHR3-0008-03 (``\href{http://aprovis3d.eu/}{APROVIS3D}''). HL and LP received funding from the ANR project  N° ANR-20-CE23-0021 (''\href{https://laurentperrinet.github.io/grant/anr-anr/}{AgileNeuroBot}''). %HL received funding from a University of Montreal Artificial Intelligence scholarship. For the purpose of open access, the author has applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission.
}
\newcommand{\presynaddr}{a} % pre address
\newcommand{\postsynaddr}{n} % post address
\newcommand{\numevent}{N_{ev}} % total number of events
\newcommand{\presynaddrspace}{\mathcal{A}} %presynaptic address space
\newcommand{\postsynaddrspace}{\mathcal{B}} %postsynaptic address space
\newcommand{\Npol}{N_\text{p}} % number of polarity
\newcommand{\Nneuron}{N_\text{n}} % number of output neurons in the layer
\newcommand{\arank}{r} % address index
\newcommand{\bias}{b} % bias for the MLR model
\newcommand{\synapse}{\sigma} % synapse
\newcommand{\synapticweight}{w} % synaptic weight
\newcommand{\synapticdelay}{d} % synaptic delay
\newcommand{\ranksyn}{s} % synapse index
\newcommand{\Nsyn}{N_{s}} % total number of synapses
\newcommand{\activeweights}{\mathcal{W}}
\newcommand{\timev}{t} % time
\newcommand{\polev}{p} % polarity
\newcommand{\event}{\epsilon} % event
\newcommand{\eventstream}{\xi} % stream of events
\newcommand{\TS}{S} % time surface
\newcommand{\neuron}{\mathbf{n}} % neuron in the SNN (defined by the spatial position and the channel)
\newcommand{\postneuron}{\mathbf{m}} % post synaptic neuron in the SNN (defined by the spatial position and the kernel)
\newcommand{\channel}{\mathbf{p}} % channel
\newcommand{\layer}{\mathbf{L}} % layer
\newcommand{\ms}{\si{\milli\second}}%
\newcommand{\us}{\si{\micro\second}}%
\newcommand{\timecontext}{T} % time context (cf HOTS) matrice gathering last event times
\newcommand{\current}{I} % post synaptic current
\newcommand{\volt}{u} % membrane potential
\newcommand{\volts}{V} % matrix of membrane potentials
\newcommand{\gain}{\gamma} % homeostatic gain
\newcommand{\simil}{\beta} % similarity value
\newcommand{\Nclass}{N_\text{class}} % number of classes for MLR:
\newcommand{\Nx}{N_\text{X}}
\newcommand{\Ny}{N_\text{Y}}
\newcommand{\Ntime}{N_\text{t}}
\newcommand{\kernel}{K} % convolution kernel
%\newcommand{\kernelind}{\mathbf{k}} % indice of the kernel
\newcommand{\kernelind}{k} % indice of the kernel
\newcommand{\Kx}{K_\text{x}}
\newcommand{\Ky}{K_\text{y}}
\newcommand{\Ktime}{K_\text{t}}
\newcommand{\classiflayer}{\mathbf{C}}
\newcommand{\class}{c} % class k of the MLR
\newcommand{\lrweights}{\theta} % matrix of MLR weights
\newcommand{\lrtrue}{y} % true value of the prediction for MLR
\newcommand{\loss}{J} % cost function for MLR
\newcommand{\softmax}{\sigma}
\newcommand{\actfreq}{f}
\newcommand{\decision}{\hat{y}}
\newcommand{\speed}{v}
\newcommand{\Nspeed}{N_v}
%
\newcommand{\colorsec}{red}
\newcommand{\colorsubsec}{gray}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{fontspec}
\usepackage{titlesec}
\titleformat*{\section}{\huge\bfseries}
\usepackage{float} %allows me to use [H] with figures to insert figures in multicol env (poster)
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage[utf8]{inputenc}
\defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
\setmainfont{Alegreya}
\DeclareMathOperator*{\argmax}{arg\,max}
\usepackage[
%style=chem-acs,
style=numeric,						% numeric style for reference list
citestyle=numeric-comp,
%style=alphabetic-verb,
giveninits=false,
maxbibnames=1,
%firstinits=true,
%style=apa,
%maxcitenames=1,
%maxnames=3,
%minnames=1,
%maxbibnames=99,
dateabbrev=true,
giveninits=true,
%uniquename=init,
url=false,
doi=false,
isbn=false,
eprint=false,
texencoding=utf8,
bibencoding=utf8,
autocite=superscript,
backend=biber,
%sorting=none,
sorting=none,
sortcites=false,
%articletitle=false
]{biblatex}%

\bibliography{references.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\columnsep=2cm % This is the amount of white space between the columns in the poster
\columnseprule=2pt % This is the thickness of the black line between the columns in the poster
\def\columnseprulecolor{\color{black}}
\usepackage{multirow}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\sffamily
\usepackage[most]{tcolorbox}
\newtcbox{\mybox}{size = normal, on line}% boxsep=3mm,
%outer arc=1mm, arc=3mm,
%boxrule=2mm,colback=red!10!white, colframe=red!50!black, arc is angular}
\begin{document}
%----------------------------------------------------------------------------------------
%	POSTER HEADER
%----------------------------------------------------------------------------------------
% The header is divided into two boxes:
% The first is 75% wide and houses the title, subtitle, names, university/organization and contact information
% The second is 25% wide and houses a logo for your university/organization or a photo of you
% The widths of these boxes can be easily edited to accommodate your content as you see fit
\vspace*{-2cm}
%
\begin{minipage}[b]{0.175\textwidth}
%\hspace*{2cm}
\includegraphics[width=.4\textwidth]{figures/int_logo.pdf}
\includegraphics[width=.6\textwidth]{figures/amu_logo.pdf}\\
%\vspace{-.5cm}
\begin{center}
\color{blue}
\Large
\href{mailto://\EmailAG}{\EmailAG} \hspace{.2cm}
\end{center}
\vspace{1cm}
\end{minipage}
%
\begin{minipage}[b]{.65\textwidth}
\begin{center}
\VeryHuge
\textbf{\color{\colorsec}
\Title
} \\ % \color{Black}
\end{center}
\large
\centering \hspace{.5cm} \textbf{
\AuthorAG , \hspace{.1cm}
%\AuthorCB , \hspace{.1cm}
%\AuthorHL  \hspace{.1cm}
\& \hspace{.1cm}
\AuthorLP
%\hspace{.5cm}
 -
%
\large
%\hspace{.1cm}
\Address} \\
%\vspace{1cm}
\end{minipage}
%
\begin{minipage}[t]{0.175\textwidth}
%
%\vskip{-8cm}
\vspace{-9cm}
%\begin{tabular} {c c}
%\includegraphics[height=.20\textwidth]{figures/cnrs_logo.pdf} & \includegraphics[height=.20\textwidth]{figures/brain-logo-240.jpg} \\
%\multicolumn{2}{c}{\includegraphics[height=.15\textwidth]{figures/chistera_logo.pdf}}\\
%\end{tabular}
\includegraphics[height=.2\textwidth]{figures/cnrs_logo.pdf}\hspace{1cm} \includegraphics[height=.2\textwidth]{figures/chistera_logo.pdf}\hspace{1cm}
%\includegraphics[height=.15\textwidth]{figures/brain-logo-240.jpg}
%\vskip{-2cm}
%\hspace*{5cm}
%\includegraphics[height=.15\textwidth]{figures/chistera_logo.pdf}\\
%\vspace*{3cm}
%\hspace{3cm}
%\includegraphics[height=.20\textwidth]{figures/cnrs_logo.pdf}
%\hspace{1cm}
%\includegraphics[height=.20\textwidth]{figures/brain-logo-240.jpg}
%\\
\vspace{.25cm}

\begin{center}
\color{blue}
\Large
\href{https://laurentperrinet.github.io/publication/grimaldi-22-icip/}{https://laurentperrinet.github.io
\\ /publication/grimaldi-22-icip/} \end{center}
\vspace{2cm}

\end{minipage}
%
\vspace*{-1.5cm}
\hrule
\vspace{5pt}
\hrule
%----------------------------------------------------------------------------------------
\begin{multicols}{3} % This is how many columns your poster will be broken into, a portrait poster is generally split into 2 columns
%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------
\section*{\color{\colorsec}Abstract \vspace{.3cm}  \hrule}
\vspace{-2.5cm}
\Abstract
%----------------------------------------------------------------------------------------
%	MLR
%----------------------------------------------------------------------------------------
\section*{\color{\colorsec}Heterogeneous delays model\hrule}
%
\vspace*{-2.5cm}
\subsection*{\color{\colorsubsec}Illustration}
%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.980\linewidth]{figures/HDSNN_graph.pdf}
    \caption{\textbf{The core mechanism of the HD SNN model.} \textit{(Top-Left)}~Two spiking motifs are emitted from four presynaptic neurons. Once integrated by the synapses of the postsynaptic neuron~\textit{(Right)}, the spiking motifs are shifted in time by the synaptic delays and weighted by the synaptic weights~\textit{(Middle-Left)}. When they reach the soma of the postsynaptic neuron, the different spikes contribute to a modification of its membrane potential according to an activation function. In this example, we use the same activation function as for a Leaky Integrate and Fire neuron~\textit{(Bottom-Left)}. The first spiking motif is synchronized by the synaptic delays and causes a sudden rise in the membrane potential of the postsynaptic neuron. An output spike is emitted when the membrane potential reaches the threshold and it is then reset.   \textit{(Right)}~An illustration of a spiking neuron with different synaptic weights (represented by the thickness of the synapses) and different synaptic delays (represented by the length of the synapses). }%
    \label{fig:izhikevich}%
\end{figure}
%TODO: changer le temps d'occurence des spikes
%\vspace*{1.5cm}
\subsection*{\color{\colorsubsec}Mathematical formalism}
%
\textbf{Event stream:}
%The spikes reaching our SNN can be formalized as:
$$
\mybox{$\event = \{(\presynaddr_\arank, \timev_\arank)\}_{\arank \in [1,\numevent]}$}
$$
where $\numevent \in \mathbb{N} $ is the total number of events, $\timev_\arank$ is the time occurrence of event number $\arank$ and $\presynaddr_\arank$ an associated address , which is typically in the form $\presynaddr_\arank=(x_\arank, y_\arank, \polev_\arank)$. \\
%
\\
\textbf{Spiking neuron with hetero-synaptic delays:}
%
$$
\mybox{$\synapse^\postsynaddr = \{(\presynaddr^\postsynaddr_\ranksyn, \synapticweight^\postsynaddr_\ranksyn, \synapticdelay^\postsynaddr_\ranksyn)\}_{\ranksyn \in [1,\Nsyn^\postsynaddr]}$}
$$
is a set of $\Nsyn^\postsynaddr$ synapses, associated to neuron $\postsynaddr$, where each synapse $\synapse^\postsynaddr_\ranksyn$ is associated to a weight $\synapticweight^\postsynaddr_\ranksyn$, a delay $\synapticdelay^\postsynaddr_\ranksyn$ and a presynaptic address $\presynaddr^\postsynaddr_\ranksyn$.\\
%
\\
\textbf{Active weights:}
%
$$
\mybox{$\activeweights^\postsynaddr(t) = \{\synapticweight_\ranksyn^\postsynaddr | \presynaddr_\arank = \presynaddr_\ranksyn^\postsynaddr \; \text{and} \; \timev=\timev_\arank + \synapticdelay_\ranksyn^\postsynaddr\}_{\arank \in [1,\numevent]\text{, }\ranksyn \in [1,\Nsyn^\postsynaddr]}$}
$$
%
\textbf{Activation function (Multinomial Logistic Regression):}
%
$$
\mybox{$Pr(k=\postsynaddr \; | \; \timev) =\frac 1 Z \cdot {\exp  (\mathcal{C}^\postsynaddr(\timev) +\bias^\postsynaddr) }$}
$$
where $\mathcal{C}^\postsynaddr(\timev) = \sum \activeweights^\postsynaddr(t)
$ is the sum of the synaptic weights and $\bias^\postsynaddr$ is the bias linked to neuron $\postsynaddr$ and $Z= \sum_{c=1}^{\Nclass} Pr(k=c \; | \; \timev)$.\\
%
\\
\textbf{Temporal convolution:}\\
In this simplified model, we will consider that heterogeneous delays are limited in range such that the synaptic set can be represented by the dense matrix $\kernel^\postsynaddr$ giving for each neuron $\postsynaddr$ the weights as a function of presynaptic address and delay: $\forall {\ranksyn \in [1,\Nsyn^\postsynaddr]}, \kernel^\postsynaddr(\presynaddr_\ranksyn^\postsynaddr, \synapticdelay_\ranksyn^\postsynaddr) = \synapticweight_\ranksyn^\postsynaddr$ (see Figure~\ref{fig:kernels}). Using this dense representation, the counting $\mathcal{C}^\postsynaddr(\timev)$ defined above can be computed as a temporal convolution of the dense representation of the event stream $E$ with the dense kernels formed by the set of synapses:
$$
\mybox{$\mathcal{C}^\postsynaddr = \kernel^\postsynaddr \ast E$}
$$
%----------------------------------------------------------------------------------------
%	MOTION CLOUDS
%----------------------------------------------------------------------------------------
\section*{\color{\colorsec}Event-based input \vspace{.2cm}  \hrule}
%
\vspace{-2.5cm}
To test our model, we will quantify its ability to categorize different motions. In that order, we will first define a set of synthetic stimuli, natural images with a rigid motion or also \textit{Motion Clouds}~\cite{leon2012motion}, which are natural-like random textures for which we can control for velocity, among other parameters.
%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\linewidth]{figures/motion_task.pdf}
    \caption{
        {\bf - Motion Detection Task.} \textit{(Left)}~We use large natural images ($256\times256$) in which an aperture ($64\times64$) extracts a cropped image around the view axis. To mimic the effect of a saccadic eye movement, the view axis moves according to a stepwise random walk. We show such a trajectory with a length of $128$ time steps (green line). \textit{(Right)}~Snapshots of the synthetic event stream at different time steps (start and end frames marked by a white and black dot, respectively). The dynamics of the cropped image translated according to the trajectory as a function of time produces a naturalistic movie, which is then transformed into an event-based representation. Mimicking the retina, this representation encodes proportional increases or decreases in luminance, i.e. ON (red) and OFF (blue) events, in each pixel of the image. In the lower left corner of the snapshots, the translation vector is shown in red as one of the possible classes of motion. Note the change in the direction of motion between the third and fourth image, and also that, due to the aperture problem, contours parallel to the motion emit relatively fewer spikes.}
    \label{fig:motion_task}
\end{figure}
%
\vspace{1cm}
\hrule
%
%----------------------------------------------------------------------------------------
%	REFERENCES
%----------------------------------------------------------------------------------------
\vspace{-1cm}
\printbibliography
%----------------------------------------------------------------------------------------
%	RESULTS
%----------------------------------------------------------------------------------------
\section*{\color{\colorsec}Results \vspace{.2cm}\hrule}
% ------------------------------------------------------
\vspace{-2.5cm}
\subsection*{\color{\colorsubsec}Learning hetero-synaptic delays}
%
\vspace{-1cm}
\begin{figure}[H]
    {\centering
    %\vspace{-3cm}
    \includegraphics[width=\linewidth]{figures/motion_kernels.pdf}
    }
    %\vspace{-.5cm}
    \caption{
    	Representation of the weights for $8$ directions for one speed (among the $8 \times 3$ different kernels of the model) as learned on the dataset of naturalistic scenes. Directions are shown as red arrows on the left. The spatio-temporal kernels are represented as slices of spatial weights at different delays. Delays vary along the horizontal axis from the far right (delay of one step) to the left (delay of $12$ steps). Each image corresponds to the weights at a given delay, with excitatory and inhibitory weights in warm and cold colors, respectively. Due to the observed symmetry between the ON and OFF event streams, we report that the kernels for the OFF polarities are very similar and are not shown here.	Different kernels are selective to the different motion directions and we observe for all kernels an orientation preference perpendicular to the orientation. 
%      % These weights are associated to a specific delay on the \textit{delays} axis and to a presynaptic address defined on the two other axes. %	For the sake of clarity, the values in range $[-0.05, 0.05]$ are not shown.    One sees positive (excitatory) coefficients for the specific direction of motion but also negative (inhibitory) coefficients for other directions.
	}
    \label{fig:kernels}
\end{figure} 
% ------------------------------------------------------
\subsection*{\color{\colorsubsec}Accuracy as a function of the number of computations}
% ------------------------------------------------------
\begin{figure}[H]
    \centering
    \includegraphics[width=0.99\linewidth]{figures/motion_clouds.pdf} %
    \caption{{\bf Role of stimulus parameters in the motion detection accuracy.} Accuracy as a function of (from left to right) the mean spatial frequency, the bandwidth in spatial frequency (from a grating-like (left) to isotropic textures (right)), the bandwidth in orientation (from isotropic textures (left) to grating-like (right)), the bandwidth in speed (from a rigid motion (left) to independent frames (right)). Note that these accuracies are computed both in the case where orientation of the synthetic texture is necessarily perpendicular to the motion ('no aperture' condition) or in the generic case where orientation is independent of direction ('aperture').}
    \label{fig:motion_clouds}
\end{figure}
%----------------------------------------------------------------------------------------
%	CONCLUSIONS
%----------------------------------------------------------------------------------------
\section*{\color{\colorsec}Conclusion \vspace{.2cm} \hrule}
\vspace{-2.5cm}
%
We have introduced a generic SNN using hetero-synaptic delays and shown how it compares favorably with a state-of-the-art event-based algorithm used for classification~\cite{Lagorce17}. This shows that we may use the precise timing of a spike to enhance neural computations.
%
One advantage of our model is the generality of the approach.
Indeed, this supervised learning scheme can be extended to a novel task by defining a new set of supervision pairs (for instance supervised by local orientation) which would lead to the emergence of new kernels adapted to this new task.
This constitutes a major advantage over other algorithms which derive event-based algorithms from specific physical rules. %(see for instance~\cite{Benosman12} for computing the optic flow using the luminance conservation rule).
We aim at extending the application of this model on more generic datasets acquired in natural conditions for progressively more complex tasks such as time-to-contact maps, but also to neurophysiological data.
%
\vspace{1cm}
\hrule
%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------
\vspace{-1cm}
\section*{Acknowledgments}
\vspace{-1cm}
\Acknowledgments
%----------------------------------------------------------------------------------------
%\renewcommand*{\bibfont}{\normalfont\fontsize{20}{12}\selectfont}
%
%\printbibliography
\end{multicols}
%
\end{document}
